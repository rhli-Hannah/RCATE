% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rcate.rf.R
\name{rcate.rf}
\alias{rcate.rf}
\title{Robust estimation of treatment effect using random forests.}
\usage{
rcate.rf(
  x,
  y,
  d,
  method = "MCMEA",
  n.trees.p = 40000,
  shrinkage.p = 0.005,
  n.minobsinnode.p = 10,
  interaction.depth.p = 1,
  cv.p = 5,
  n.trees.mu = c(1:50) * 50,
  shrinkage.mu = 0.01,
  n.minobsinnode.mu = 5,
  interaction.depth.mu = 5,
  cv.mu = 5,
  n.trees.rf = 50,
  feature.frac = 0.8,
  newdata = NULL,
  minnodes = 5
)
}
\arguments{
\item{x}{matrix or a data frame of predictors.}

\item{y}{vector of response values.}

\item{d}{vector of binary treatment assignment (0 or 1).}

\item{method}{character string of CATE estimation method: "MCMEA" - modified co-variate
method with efficiency augmentation, "RL" - R-learning, or "DR" - doubly robust method.}

\item{n.trees.p}{tuning parameter the number of trees used for estimating propensity score
with GBM. the default value is 40000.}

\item{shrinkage.p}{tuning parameter the shrinkage level for estimating propensity score
with GBM. the default value is 0.005.}

\item{n.minobsinnode.p}{tuning parameter the minimum node size for estimating propensity score
with GBM. the default value is 10.}

\item{interaction.depth.p}{tuning parameter the number of interactions for estimating propensity
score with GBM. the default value is 1.}

\item{cv.p}{tuning parameter the number of folds in cross-validation for estimating propensity
score with GBM. the default value is 2.}

\item{n.trees.mu}{scalar or vector of the number of trees for estimating mean function with GBM.
The default is (1:50)*50.}

\item{shrinkage.mu}{tuning parameter the shrinkage level for estimating mean function
with GBM. the default value is 0.01.}

\item{n.minobsinnode.mu}{tuning parameter the minimum node size for estimating mean function
with GBM. the default value is 10.}

\item{interaction.depth.mu}{tuning parameter the number of interactions for estimating mean
function with GBM. the default value is 5.}

\item{cv.mu}{tuning parameter the folds for cross-validation for estimating mean function with
GBM. The default value is 5.}

\item{n.trees.rf}{tuning parameter the number of trees used in GBM for estimating treatment
effect function if algorithm="GBM". The default is 1000.}

\item{feature.frac}{tuning parameter the number of interactions for estimating treatment
effect function if algorithm="GBM". The default value is 2.}

\item{minnodes}{vector of the dropout rate of each hidden layer if algorithm='NN'.
The default is no dropout.}
}
\value{
a list of components
\itemize{
 \item fit - estimation method.
 \item importance - vector of variable importance.
 \item tree - trees' structure and needed parameters.
 \item data - training data.
 \item nodepreds - leaf nodes predictions.
 }
}
\description{
\code{rcate.rf} return robust estimation of treatment effect using random forests.
}
\examples{
n <- 1000; p <- 3
X <- as.data.frame(matrix(runif(n*p,-3,3),nrow=n,ncol=p)); set.seed(2223)
tau = 6*sin(2*X[,1])+3*(X[,2]+3)*X[,3]
p = 1/(1+exp(-X[,1]+X[,2]))
d = rbinom(n,1,p)
t = 2*d-1
y = 100+4*X[,1]+X[,2]-3*X[,3]+tau*t/2 + rnorm(n,0,1); set.seed(2223)
x_val = as.data.frame(matrix(rnorm(200*3,0,1),nrow=200,ncol=3))
tau_val = 6*sin(2*x_val[,1])+3*(x_val[,2]+3)*x_val[,3]

# Use MCM-EA transformation and GBM to estimate CATE
fit <- rcate.rf(X,y,d,method='DR',feature.frac = 0.8, minnodes = 3, n.trees.rf = 5)
y_pred <- predict.rcate.rf(fit,x_val)$pred
plot(tau_val,y_pred);abline(0,1)
}
